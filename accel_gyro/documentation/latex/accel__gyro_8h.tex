\hypertarget{accel__gyro_8h}{}\doxysection{src/accel\+\_\+gyro.h File Reference}
\label{accel__gyro_8h}\index{src/accel\_gyro.h@{src/accel\_gyro.h}}


Header file for the library for 6DOF IMU 5 CLICK(ICM-\/20789). Uses SPI bus to interface with the sensor.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$fcntl.\+h$>$}\newline
{\ttfamily \#include $<$sys/ioctl.\+h$>$}\newline
{\ttfamily \#include $<$linux/types.\+h$>$}\newline
{\ttfamily \#include $<$linux/spi/spidev.\+h$>$}\newline
{\ttfamily \#include $<$sys/time.\+h$>$}\newline
Include dependency graph for accel\+\_\+gyro.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsensor__data}{sensor\+\_\+data}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{accel__gyro_8h_a3f71376a97ce8e17a0468976054461cf}\label{accel__gyro_8h_a3f71376a97ce8e17a0468976054461cf}} 
\#define {\bfseries READ\+\_\+\+BIT}(b)~((0x80) $\vert$ (b)) /$\ast$ Sets the fisrt bit to 1$\ast$/
\item 
\mbox{\Hypertarget{accel__gyro_8h_a9ec95d3b2efe646e667b54110da57f2b}\label{accel__gyro_8h_a9ec95d3b2efe646e667b54110da57f2b}} 
\#define {\bfseries WHOAMI\+\_\+\+ADDR}~0x75
\item 
\mbox{\Hypertarget{accel__gyro_8h_abf99e5393854f69e3d56d19b20187e1c}\label{accel__gyro_8h_abf99e5393854f69e3d56d19b20187e1c}} 
\#define {\bfseries GYRO\+\_\+\+CTRL\+\_\+\+ADDR}~0x1B
\item 
\mbox{\Hypertarget{accel__gyro_8h_a4330a223f55e41dba41388aafa292dbb}\label{accel__gyro_8h_a4330a223f55e41dba41388aafa292dbb}} 
\#define {\bfseries ACCEL\+\_\+\+CTRL1\+\_\+\+ADDR}~0x1C
\item 
\mbox{\Hypertarget{accel__gyro_8h_a5de9d8184c47f090ddaecb2340c077a3}\label{accel__gyro_8h_a5de9d8184c47f090ddaecb2340c077a3}} 
\#define {\bfseries ACCEL\+\_\+\+CTRL2\+\_\+\+ADDR}~0x1D
\item 
\mbox{\Hypertarget{accel__gyro_8h_ad72c8e04be5eba40115e764f042395ff}\label{accel__gyro_8h_ad72c8e04be5eba40115e764f042395ff}} 
\#define {\bfseries ACCEL\+\_\+\+XOUT\+\_\+\+H\+\_\+\+ADDR}~0x3B
\item 
\mbox{\Hypertarget{accel__gyro_8h_ab4f7f23389cae1d6a74e58f7d2831986}\label{accel__gyro_8h_ab4f7f23389cae1d6a74e58f7d2831986}} 
\#define {\bfseries ACCEL\+\_\+\+XOUT\+\_\+\+L\+\_\+\+ADDR}~0x3C
\item 
\mbox{\Hypertarget{accel__gyro_8h_af1f7e1c958168cee3f591705363bb7d8}\label{accel__gyro_8h_af1f7e1c958168cee3f591705363bb7d8}} 
\#define {\bfseries ACCEL\+\_\+\+YOUT\+\_\+\+H\+\_\+\+ADDR}~0x3D
\item 
\mbox{\Hypertarget{accel__gyro_8h_aac56f15f287956556b589c45b045cfce}\label{accel__gyro_8h_aac56f15f287956556b589c45b045cfce}} 
\#define {\bfseries ACCEL\+\_\+\+YOUT\+\_\+\+L\+\_\+\+ADDR}~0x3E
\item 
\mbox{\Hypertarget{accel__gyro_8h_a5a84294f6a563822aecd79189018aeb9}\label{accel__gyro_8h_a5a84294f6a563822aecd79189018aeb9}} 
\#define {\bfseries ACCEL\+\_\+\+ZOUT\+\_\+\+H\+\_\+\+ADDR}~0x3F
\item 
\mbox{\Hypertarget{accel__gyro_8h_a4b66c3e3f192e872fda4f049bfc99249}\label{accel__gyro_8h_a4b66c3e3f192e872fda4f049bfc99249}} 
\#define {\bfseries ACCEL\+\_\+\+ZOUT\+\_\+\+L\+\_\+\+ADDR}~0x40
\item 
\mbox{\Hypertarget{accel__gyro_8h_aef736e66f248c3d248a9bdcfa9f0e557}\label{accel__gyro_8h_aef736e66f248c3d248a9bdcfa9f0e557}} 
\#define {\bfseries GYRO\+\_\+\+XOUT\+\_\+\+H\+\_\+\+ADDR}~0x43
\item 
\mbox{\Hypertarget{accel__gyro_8h_ad34db2e67133e8a333f704d7f312c2da}\label{accel__gyro_8h_ad34db2e67133e8a333f704d7f312c2da}} 
\#define {\bfseries GYRO\+\_\+\+XOUT\+\_\+\+L\+\_\+\+ADDR}~0x44
\item 
\mbox{\Hypertarget{accel__gyro_8h_a60ae95adda3cf461c9ff53189d826f61}\label{accel__gyro_8h_a60ae95adda3cf461c9ff53189d826f61}} 
\#define {\bfseries GYRO\+\_\+\+YOUT\+\_\+\+H\+\_\+\+ADDR}~0x45
\item 
\mbox{\Hypertarget{accel__gyro_8h_a93587797cc76c2953017d146a7434730}\label{accel__gyro_8h_a93587797cc76c2953017d146a7434730}} 
\#define {\bfseries GYRO\+\_\+\+YOUT\+\_\+\+L\+\_\+\+ADDR}~0x46
\item 
\mbox{\Hypertarget{accel__gyro_8h_a267d35349636eb03b5faea70b3ca1351}\label{accel__gyro_8h_a267d35349636eb03b5faea70b3ca1351}} 
\#define {\bfseries GYRO\+\_\+\+ZOUT\+\_\+\+H\+\_\+\+ADDR}~0x47
\item 
\mbox{\Hypertarget{accel__gyro_8h_a0df97a99c28d014ab2b0a157078b6a9c}\label{accel__gyro_8h_a0df97a99c28d014ab2b0a157078b6a9c}} 
\#define {\bfseries GYRO\+\_\+\+ZOUT\+\_\+\+L\+\_\+\+ADDR}~0x48
\item 
\mbox{\Hypertarget{accel__gyro_8h_aaf8a6d1fd56ace5824a8fa9c0a4fa3cd}\label{accel__gyro_8h_aaf8a6d1fd56ace5824a8fa9c0a4fa3cd}} 
\#define {\bfseries PWR\+\_\+\+MGMT\+\_\+1\+\_\+\+ADDR}~0x6B
\item 
\mbox{\Hypertarget{accel__gyro_8h_a1005293803db53dc160fd3a67e27e9e1}\label{accel__gyro_8h_a1005293803db53dc160fd3a67e27e9e1}} 
\#define {\bfseries ACCEL\+\_\+\+CTRL1\+\_\+\+CONF}~0x18
\item 
\mbox{\Hypertarget{accel__gyro_8h_ada87c90640ec6b9a1e1b6f2148ffe029}\label{accel__gyro_8h_ada87c90640ec6b9a1e1b6f2148ffe029}} 
\#define {\bfseries GYRO\+\_\+\+CTRL\+\_\+\+CONF}~0x18
\item 
\mbox{\Hypertarget{accel__gyro_8h_aa90f66a50aa78746a96c7c5ceac2133b}\label{accel__gyro_8h_aa90f66a50aa78746a96c7c5ceac2133b}} 
\#define {\bfseries ACCEL\+\_\+\+CONV\+\_\+\+CONST}~2048.\+00
\item 
\mbox{\Hypertarget{accel__gyro_8h_a21c37669c5609d136cdae25f87a23ccb}\label{accel__gyro_8h_a21c37669c5609d136cdae25f87a23ccb}} 
\#define {\bfseries GYRO\+\_\+\+CONV\+\_\+\+CONST}~16.\+4
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_ad836fed344e03cc6d866386f7af7eb59}{open\+\_\+spi\+\_\+bus}} ()
\begin{DoxyCompactList}\small\item\em Opens SPI bus. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_abc94bc066cbfa50dd6112fdefe01d8bc}{close\+\_\+spi\+\_\+bus}} ()
\begin{DoxyCompactList}\small\item\em Closes SPI bus. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_aa1ec2637ab52ec869f59a6d28c9e6778}{sensor\+\_\+config}} ()
\begin{DoxyCompactList}\small\item\em Configurs sensor. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_a514d1d933a7f8b5e6a610edc8ecd5bf7}{read\+\_\+accel\+\_\+xyz}} ()
\begin{DoxyCompactList}\small\item\em Reads Accel XYZ and puts them in ACCEL\+\_\+\+XYZ. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_a54ff564d04a24c734d6f4442a109c5a9}{read\+\_\+gyro\+\_\+xyz}} ()
\begin{DoxyCompactList}\small\item\em Reads Gyro XYZ and puts them in GYRO\+\_\+\+XYZ. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_a55dd7740395cefc7771330f5db17ca1a}{read\+\_\+whoami}} ()
\begin{DoxyCompactList}\small\item\em Reads Who am I reg. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_aecd4d40022e855b9c59e4487dca2dd1b}{read\+\_\+registar}} (unsigned char)
\begin{DoxyCompactList}\small\item\em Reads 1B from a register. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_a76a9b6beed2713cff20db426a2c71510}{write\+\_\+registar}} (unsigned char, unsigned char)
\begin{DoxyCompactList}\small\item\em Writes 1B to a register. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{accel__gyro_8h_a0f43b2f3809519696e6988217d83b99f}{calculate\+\_\+error}} ()
\begin{DoxyCompactList}\small\item\em Gets the error correction values for accel and gyro. Puts them in ACCEL\+\_\+\+ERROR and GYRO\+\_\+\+ERROR. Sensor needs to be completely flat. \end{DoxyCompactList}\item 
long long \mbox{\hyperlink{accel__gyro_8h_ab740a03eaac6bf7f0bb65d94af2035e5}{current\+\_\+time}} ()
\begin{DoxyCompactList}\small\item\em Gets current time in miliseconds. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{accel__gyro_8h_a16cdc2a9f144c80a554cd6e27f07c4c9}{get\+Angles}} ()
\begin{DoxyCompactList}\small\item\em Get the Angles object and puts them in angles. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{accel__gyro_8h_a096a9bd97d33f9ea18c43dc058e00045}\label{accel__gyro_8h_a096a9bd97d33f9ea18c43dc058e00045}} 
volatile struct \mbox{\hyperlink{structsensor__data}{sensor\+\_\+data}} {\bfseries ACCEL\+\_\+\+XYZ}
\item 
\mbox{\Hypertarget{accel__gyro_8h_ab776d3e0087b9f8729748577aec8fcb6}\label{accel__gyro_8h_ab776d3e0087b9f8729748577aec8fcb6}} 
volatile struct \mbox{\hyperlink{structsensor__data}{sensor\+\_\+data}} {\bfseries GYRO\+\_\+\+XYZ}
\item 
\mbox{\Hypertarget{accel__gyro_8h_a72df860c097aed92f6829759ecb24215}\label{accel__gyro_8h_a72df860c097aed92f6829759ecb24215}} 
volatile struct \mbox{\hyperlink{structsensor__data}{sensor\+\_\+data}} {\bfseries angles}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Header file for the library for 6DOF IMU 5 CLICK(ICM-\/20789). Uses SPI bus to interface with the sensor. 

\begin{DoxyAuthor}{Author}
Aleksandar Bešlić (\href{mailto:alex.beslic@gmail.com}{\texttt{ alex.\+beslic@gmail.\+com}}) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+8 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2022-\/08-\/29
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2022 
\end{DoxyCopyright}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{accel__gyro_8h_a0f43b2f3809519696e6988217d83b99f}\label{accel__gyro_8h_a0f43b2f3809519696e6988217d83b99f}} 
\index{accel\_gyro.h@{accel\_gyro.h}!calculate\_error@{calculate\_error}}
\index{calculate\_error@{calculate\_error}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{calculate\_error()}{calculate\_error()}}
{\footnotesize\ttfamily uint8\+\_\+t calculate\+\_\+error (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Gets the error correction values for accel and gyro. Puts them in ACCEL\+\_\+\+ERROR and GYRO\+\_\+\+ERROR. Sensor needs to be completely flat. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_abc94bc066cbfa50dd6112fdefe01d8bc}\label{accel__gyro_8h_abc94bc066cbfa50dd6112fdefe01d8bc}} 
\index{accel\_gyro.h@{accel\_gyro.h}!close\_spi\_bus@{close\_spi\_bus}}
\index{close\_spi\_bus@{close\_spi\_bus}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{close\_spi\_bus()}{close\_spi\_bus()}}
{\footnotesize\ttfamily uint8\+\_\+t close\+\_\+spi\+\_\+bus (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Closes SPI bus. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_ab740a03eaac6bf7f0bb65d94af2035e5}\label{accel__gyro_8h_ab740a03eaac6bf7f0bb65d94af2035e5}} 
\index{accel\_gyro.h@{accel\_gyro.h}!current\_time@{current\_time}}
\index{current\_time@{current\_time}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{current\_time()}{current\_time()}}
{\footnotesize\ttfamily long long current\+\_\+time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Gets current time in miliseconds. 

\begin{DoxyReturn}{Returns}
long long time in miliseconds 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_a16cdc2a9f144c80a554cd6e27f07c4c9}\label{accel__gyro_8h_a16cdc2a9f144c80a554cd6e27f07c4c9}} 
\index{accel\_gyro.h@{accel\_gyro.h}!getAngles@{getAngles}}
\index{getAngles@{getAngles}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{getAngles()}{getAngles()}}
{\footnotesize\ttfamily void get\+Angles (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Get the Angles object and puts them in angles. 

\mbox{\Hypertarget{accel__gyro_8h_ad836fed344e03cc6d866386f7af7eb59}\label{accel__gyro_8h_ad836fed344e03cc6d866386f7af7eb59}} 
\index{accel\_gyro.h@{accel\_gyro.h}!open\_spi\_bus@{open\_spi\_bus}}
\index{open\_spi\_bus@{open\_spi\_bus}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{open\_spi\_bus()}{open\_spi\_bus()}}
{\footnotesize\ttfamily uint8\+\_\+t open\+\_\+spi\+\_\+bus (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Opens SPI bus. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_a514d1d933a7f8b5e6a610edc8ecd5bf7}\label{accel__gyro_8h_a514d1d933a7f8b5e6a610edc8ecd5bf7}} 
\index{accel\_gyro.h@{accel\_gyro.h}!read\_accel\_xyz@{read\_accel\_xyz}}
\index{read\_accel\_xyz@{read\_accel\_xyz}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{read\_accel\_xyz()}{read\_accel\_xyz()}}
{\footnotesize\ttfamily uint8\+\_\+t read\+\_\+accel\+\_\+xyz (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Reads Accel XYZ and puts them in ACCEL\+\_\+\+XYZ. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_a54ff564d04a24c734d6f4442a109c5a9}\label{accel__gyro_8h_a54ff564d04a24c734d6f4442a109c5a9}} 
\index{accel\_gyro.h@{accel\_gyro.h}!read\_gyro\_xyz@{read\_gyro\_xyz}}
\index{read\_gyro\_xyz@{read\_gyro\_xyz}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{read\_gyro\_xyz()}{read\_gyro\_xyz()}}
{\footnotesize\ttfamily uint8\+\_\+t read\+\_\+gyro\+\_\+xyz (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Reads Gyro XYZ and puts them in GYRO\+\_\+\+XYZ. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure; 2 -\/ Data not ready) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_aecd4d40022e855b9c59e4487dca2dd1b}\label{accel__gyro_8h_aecd4d40022e855b9c59e4487dca2dd1b}} 
\index{accel\_gyro.h@{accel\_gyro.h}!read\_registar@{read\_registar}}
\index{read\_registar@{read\_registar}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{read\_registar()}{read\_registar()}}
{\footnotesize\ttfamily uint8\+\_\+t read\+\_\+registar (\begin{DoxyParamCaption}\item[{unsigned char}]{reg }\end{DoxyParamCaption})}



Reads 1B from a register. 


\begin{DoxyParams}{Parameters}
{\em reg} & Address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_a55dd7740395cefc7771330f5db17ca1a}\label{accel__gyro_8h_a55dd7740395cefc7771330f5db17ca1a}} 
\index{accel\_gyro.h@{accel\_gyro.h}!read\_whoami@{read\_whoami}}
\index{read\_whoami@{read\_whoami}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{read\_whoami()}{read\_whoami()}}
{\footnotesize\ttfamily uint8\+\_\+t read\+\_\+whoami (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Reads Who am I reg. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_aa1ec2637ab52ec869f59a6d28c9e6778}\label{accel__gyro_8h_aa1ec2637ab52ec869f59a6d28c9e6778}} 
\index{accel\_gyro.h@{accel\_gyro.h}!sensor\_config@{sensor\_config}}
\index{sensor\_config@{sensor\_config}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{sensor\_config()}{sensor\_config()}}
{\footnotesize\ttfamily uint8\+\_\+t sensor\+\_\+config (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Configurs sensor. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
\mbox{\Hypertarget{accel__gyro_8h_a76a9b6beed2713cff20db426a2c71510}\label{accel__gyro_8h_a76a9b6beed2713cff20db426a2c71510}} 
\index{accel\_gyro.h@{accel\_gyro.h}!write\_registar@{write\_registar}}
\index{write\_registar@{write\_registar}!accel\_gyro.h@{accel\_gyro.h}}
\doxysubsubsection{\texorpdfstring{write\_registar()}{write\_registar()}}
{\footnotesize\ttfamily uint8\+\_\+t write\+\_\+registar (\begin{DoxyParamCaption}\item[{unsigned char}]{reg,  }\item[{unsigned char}]{val }\end{DoxyParamCaption})}



Writes 1B to a register. 


\begin{DoxyParams}{Parameters}
{\em reg} & Address \\
\hline
{\em val} & Value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint8\+\_\+t (0 -\/ on success; 1 -\/ on failure) 
\end{DoxyReturn}
